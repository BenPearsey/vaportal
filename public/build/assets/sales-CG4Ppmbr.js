import{r as h,j as e,L as J,$ as K,S as v,t as A}from"./app-DUSEAaDk.js";import{C as Q,a as X,b as ee,c as te}from"./card-DLziDOQe.js";import{c as P,B as i}from"./app-logo-icon-niQwcySJ.js";import{I as ae}from"./index-CsbLVuVn.js";import{T as le,a as se,b as T,c as n,d as ne,e as r}from"./table-DFxtelq1.js";import{D as L,a as $,b as I,c as E}from"./dialog-h4m6KRJP.js";import{A as re}from"./app-layout-admin-bPDzceOK.js";import{C as F}from"./checkbox-Dj6NJVxR.js";import{p as M}from"./products-FRIolfiG.js";import{D as U,a as H,b as R,c as b}from"./use-mobile-navigation-xAdiOegP.js";import{S as ie}from"./SaleChecklist-DKrXlDy1.js";import{F as ce}from"./filter-DnKLZ143.js";import{D as oe}from"./download-CYFmTqDM.js";import{E as de}from"./eye-Dzot2m_d.js";import{C as he}from"./clipboard-list-Dg4pp0_3.js";import{T as me}from"./trash-CG0kyJwJ.js";import"./sonner-BAI07Ub3.js";import"./briefcase-business-D4N79Uzy.js";import"./users-Dz1g4iLP.js";import"./user-plus-BCs7l9Mm.js";import"./index-DDuQ3gsv.js";import"./index-BxwQjuZr.js";import"./Checklist-Df5g09Pz.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],je=P("FilePlus",xe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],pe=P("SquareCheckBig",ue),fe=[{title:"Home",href:"/admin/dashboard"},{title:"Sales",href:"/admin/sales"}],B=["Waiting for Funds","Waiting for Documents","Processing","Waiting for Carrier","Completed","Cancelled"];function Pe({sales:V}){const[d,O]=h.useState(V),[m,g]=h.useState([]),[C,w]=h.useState("All"),[y,q]=h.useState(""),[S,x]=h.useState(null),z=t=>g(l=>l.includes(t)?l.filter(s=>s!==t):[...l,t]),W=t=>{O(l=>l.map(s=>m.includes(s.sale_id)?{...s,status:t}:s)),g([])},Y=()=>{const t=`Sale ID,Agent,Client,Email,Phone,Carrier,Sale Type,Total Sale,Commission,Status,Sale Date
`+d.map(a=>{var k,D,_;const j=a.agent&&typeof a.agent=="object"?`${a.agent.firstname} ${a.agent.lastname}`:"N/A",u=a.client&&typeof a.client=="object"?`${a.client.firstname} ${a.client.lastname}`:"N/A",p=((k=a.client)==null?void 0:k.email)??"N/A",f=((D=a.client)==null?void 0:D.phone)??"N/A";return[a.sale_id,j,u,p,f,((_=a.carrier_info)==null?void 0:_.name)??"N/A",M(a.product),a.total_sale_amount,a.commission,a.status,a.sale_date].join(",")}).join(`
`),l=new Blob([t],{type:"text/csv"}),s=URL.createObjectURL(l),c=document.createElement("a");c.href=s,c.download="sales.csv",c.click(),URL.revokeObjectURL(s)},Z=d.filter(t=>{var a,j,u,p,f;const l=y.toLowerCase(),s=`${((a=t.client)==null?void 0:a.firstname)??""} ${((j=t.client)==null?void 0:j.lastname)??""}`.toLowerCase().includes(l)||`${((u=t.agent)==null?void 0:u.firstname)??""} ${((p=t.agent)==null?void 0:p.lastname)??""}`.toLowerCase().includes(l)||(((f=t.client)==null?void 0:f.email)??"").toLowerCase().includes(l),c=C==="All"||t.status===C;return s&&c}),[o,N]=h.useState(null),G=()=>{S!==null&&(v.delete(route("admin.sales.destroy",S),{},{onSuccess:()=>{A.success("Sale deleted"),v.reload({only:["sales"]})},onError:()=>A.error("Failed to delete sale")}),x(null))};return e.jsxs(re,{breadcrumbs:fe,children:[e.jsx(J,{title:"Sales"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 rounded-xl p-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsx(ae,{placeholder:"Search by client, agent, or email",className:"w-full md:w-1/3",value:y,onChange:t=>q(t.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(U,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(i,{variant:"outline",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),C]})}),e.jsxs(R,{children:[e.jsx(b,{onClick:()=>w("All"),children:"All"}),B.map(t=>e.jsx(b,{onClick:()=>w(t),children:t},t))]})]}),e.jsxs(U,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(i,{variant:"default",disabled:!m.length,children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Change Status"]})}),e.jsx(R,{children:B.map(t=>e.jsx(b,{onClick:()=>W(t),children:t},t))})]}),e.jsxs(i,{variant:"outline",onClick:Y,children:[e.jsx(oe,{className:"mr-2 h-4 w-4"}),"Export CSV"]}),e.jsxs(i,{variant:"default",onClick:()=>window.location.href="/admin/sales/create",children:[e.jsx(je,{className:"mr-2 h-4 w-4"}),"New Sale"]})]})]}),e.jsxs(Q,{children:[e.jsx(X,{children:e.jsx(ee,{children:"Sales"})}),e.jsx(te,{children:e.jsxs(le,{children:[e.jsx(se,{children:e.jsxs(T,{children:[e.jsx(n,{children:e.jsx(F,{checked:m.length===d.length&&d.length,onCheckedChange:()=>g(m.length===d.length?[]:d.map(t=>t.sale_id))})}),e.jsx(n,{children:"Sale ID"}),e.jsx(n,{children:"Agent"}),e.jsx(n,{children:"Client"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Phone"}),e.jsx(n,{children:"Carrier"}),e.jsx(n,{children:"Sale Type"}),e.jsx(n,{children:"Total"}),e.jsx(n,{children:"Commission"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Date"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(ne,{children:Z.map(t=>{var l,s,c;return e.jsxs(T,{children:[e.jsx(r,{children:e.jsx(F,{checked:m.includes(t.sale_id),onCheckedChange:()=>z(t.sale_id)})}),e.jsx(r,{children:t.sale_id}),e.jsx(r,{children:t.agent&&typeof t.agent=="object"?`${t.agent.firstname} ${t.agent.lastname}`:"N/A"}),e.jsx(r,{children:t.client&&typeof t.client=="object"?`${t.client.firstname} ${t.client.lastname}`:"N/A"}),e.jsx(r,{children:((l=t.client)==null?void 0:l.email)??"N/A"}),e.jsx(r,{children:((s=t.client)==null?void 0:s.phone)??"N/A"}),e.jsx(r,{children:((c=t.carrier_info)==null?void 0:c.name)??"N/A"}),e.jsx(r,{children:M(t.product)}),e.jsx(r,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(t.total_sale_amount))}),e.jsx(r,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(t.commission))}),e.jsx(r,{children:t.status}),e.jsx(r,{children:t.sale_date}),e.jsxs(r,{className:"flex gap-2",children:[e.jsx(K,{href:route("admin.sales.show",t.sale_id),title:"View",children:e.jsx(i,{variant:"ghost",children:e.jsx(de,{className:"h-5 w-5 text-gray-500"})})}),e.jsx(i,{variant:"ghost",title:"Checklist",onClick:()=>N(t),children:e.jsx(he,{className:"h-5 w-5 text-gray-500"})}),e.jsx(i,{variant:"ghost",title:"Delete",onClick:()=>x(t.sale_id),children:e.jsx(me,{className:"h-5 w-5 text-red-500"})})]})]},t.sale_id)})})]})})]})]}),e.jsx(L,{open:S!==null,onOpenChange:()=>x(null),children:e.jsxs($,{children:[e.jsx(I,{children:e.jsx(E,{children:"Delete Sale?"})}),e.jsx("p",{children:"Are you sure you want to permanently delete this sale?"}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx(i,{variant:"destructive",onClick:G,children:"Yes, delete"}),e.jsx(i,{onClick:()=>x(null),children:"Cancel"})]})]})}),e.jsx(L,{open:!!o,onOpenChange:()=>N(null),children:e.jsxs($,{children:[e.jsx(I,{children:e.jsxs(E,{children:["Checklist – Sale #",o==null?void 0:o.sale_id]})}),o&&e.jsx(ie,{saleId:o.sale_id,checklist:o.checklist})]})})]})}export{Pe as default};
