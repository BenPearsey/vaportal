import{m as y,r as j,a as w,j as e,L,S as V,t as g}from"./app-DUSEAaDk.js";import{A as E}from"./app-layout-agent-jUzQTb5-.js";import{C as $,a as D,b as I,c as T}from"./card-DLziDOQe.js";import{B as S}from"./app-logo-icon-niQwcySJ.js";import{L as r}from"./label-DgKyff4V.js";import{I as x}from"./index-CsbLVuVn.js";import{S as n,a as c,b as d,c as o,d as i}from"./select-Z5_1GfMY.js";import"./use-mobile-navigation-xAdiOegP.js";import"./index-DDuQ3gsv.js";import"./sonner-BAI07Ub3.js";import"./briefcase-business-D4N79Uzy.js";import"./user-C2oc2Una.js";import"./index-BxwQjuZr.js";import"./chevron-up-Dflxa-R7.js";function Q({clients:v,products:f,statuses:h}){const{data:l,setData:t,post:C,processing:u,errors:a,reset:_}=y({client_id:"",product:"",carrier:"",total_sale_amount:"",commission:"",sale_date:"",status:h[0]||""}),[p,m]=j.useState([]);j.useEffect(()=>{if(!l.product){m([]),t("carrier","");return}w.get(route("agent.sales.carriers"),{params:{product:l.product}}).then(s=>{m(s.data||[]),t("carrier","")}).catch(()=>{m([])})},[l.product]);function N(s){s.preventDefault(),C(route("agent.sales.store"),{onSuccess:()=>{g.success("Sale created and admins notified."),_()},onError:()=>{g.error("Couldn’t create the sale.")}})}const b=s=>s.replace(/_/g," ").replace(/\b\w/g,A=>A.toUpperCase());return e.jsxs(E,{breadcrumbs:[{title:"Sales",href:route("agent.sales")},{title:"Add Sale",href:""}],children:[e.jsx(L,{title:"Add New Sale"}),e.jsx("div",{className:"p-6",children:e.jsxs($,{children:[e.jsx(D,{children:e.jsx(I,{children:"Add New Sale"})}),e.jsx(T,{children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(r,{children:"Client"}),e.jsxs(n,{onValueChange:s=>t("client_id",s),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select a client"})}),e.jsx(o,{children:v.map(s=>e.jsxs(i,{value:String(s.id),children:[s.firstname," ",s.lastname]},`client-${s.id}`))})]}),a.client_id&&e.jsx("p",{className:"text-red-500 text-sm",children:a.client_id})]}),e.jsx(S,{type:"button",variant:"outline",onClick:()=>V.get(route("agent.clients.create")),children:"+ Add New Client"})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Product"}),e.jsxs(n,{onValueChange:s=>t("product",s),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select a product"})}),e.jsx(o,{children:f.map(s=>e.jsx(i,{value:s,children:b(s)},`prod-${s}`))})]}),a.product&&e.jsx("p",{className:"text-red-500 text-sm",children:a.product})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Carrier"}),e.jsxs(n,{onValueChange:s=>t("carrier",s),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select a carrier"})}),e.jsx(o,{children:p.length>0?p.map(s=>e.jsx(i,{value:String(s.id),children:s.name},`carr-${s.id}`)):e.jsx(i,{value:"no-carriers",disabled:!0,children:"No carriers available"},"no-carriers")})]}),a.carrier&&e.jsx("p",{className:"text-red-500 text-sm",children:a.carrier})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Total Sale Amount"}),e.jsx(x,{type:"number",value:l.total_sale_amount,onChange:s=>t("total_sale_amount",s.target.value)}),a.total_sale_amount&&e.jsx("p",{className:"text-red-500 text-sm",children:a.total_sale_amount})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Commission"}),e.jsx(x,{type:"number",value:l.commission,onChange:s=>t("commission",s.target.value)}),a.commission&&e.jsx("p",{className:"text-red-500 text-sm",children:a.commission})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Sale Date"}),e.jsx(x,{type:"date",value:l.sale_date,onChange:s=>t("sale_date",s.target.value)}),a.sale_date&&e.jsx("p",{className:"text-red-500 text-sm",children:a.sale_date})]})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Status"}),e.jsxs(n,{onValueChange:s=>t("status",s),children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Select status"})}),e.jsx(o,{children:h.map(s=>e.jsx(i,{value:s,children:s},`stat-${s}`))})]}),a.status&&e.jsx("p",{className:"text-red-500 text-sm",children:a.status})]}),e.jsx(S,{type:"submit",disabled:u,className:"w-full",children:u?"Saving…":"Save Sale"})]})})]})})]})}export{Q as default};
