import{m as F,r as l,j as e,L as D,t as o,S as E,a as k}from"./app-DUSEAaDk.js";import{A as w}from"./app-layout-admin-bPDzceOK.js";import{C as R,a as T,b as I,c as L}from"./card-DLziDOQe.js";import{I as j}from"./index-CsbLVuVn.js";import{B as U}from"./app-logo-icon-niQwcySJ.js";import{d as B,S as y}from"./SlateEditor-DwhKE_qS.js";import"./use-mobile-navigation-xAdiOegP.js";import"./index-DDuQ3gsv.js";import"./sonner-BAI07Ub3.js";import"./briefcase-business-D4N79Uzy.js";import"./users-Dz1g4iLP.js";import"./user-plus-BCs7l9Mm.js";import"./index.es-CrC4eOKT.js";const H={title:"",type:"text",content:"",description:""},r=B,J=[{title:"Home",href:"/admin/dashboard"},{title:"Announcements",href:"/admin/manage-announcements"},{title:"Add Announcement",href:"/admin/add-announcement"}];function $(){const{data:s,setData:c,post:g,processing:p,errors:a,reset:b}=F(H),[d,x]=l.useState(null),[m,v]=l.useState(r),h=l.useRef(r),[u,A]=l.useState(r),f=l.useRef(r),S=m&&Array.isArray(m)&&m.length>0?m:r,N=u&&Array.isArray(u)&&u.length>0?u:r,C=async t=>{o.loading("Uploading file...");const n=new FormData;n.append("file",t);try{const i=await k.post(route("announcements.upload"),n,{headers:{"Content-Type":"multipart/form-data"}});return o.success("Upload successful"),i.data.url}catch(i){throw console.error("File upload error:",i),o.error("File upload failed"),i}},V=async t=>{t.preventDefault();const n=o.loading("Posting announcement...");try{s.type==="text"?s.content=JSON.stringify(h.current):(s.type==="image"||s.type==="video")&&(d&&(s.content=await C(d)),s.description=JSON.stringify(f.current)),g(route("announcements.store"),{onSuccess:()=>{o.success("Announcement posted successfully!",{id:n}),b(),E.get(route("admin.dashboard"))},onError:()=>{o.error("Announcement posting failed!",{id:n})}})}catch(i){console.error("Submission error:",i),o.error("Announcement posting failed!",{id:n})}};return e.jsxs(w,{breadcrumbs:J,children:[e.jsx(D,{title:"Add Announcement"}),e.jsx("div",{className:"p-6",children:e.jsxs(R,{children:[e.jsx(T,{children:e.jsx(I,{children:"Add Announcement"})}),e.jsx(L,{children:e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium",children:"Title"}),e.jsx(j,{id:"title",type:"text",value:s.title,onChange:t=>c("title",t.target.value),placeholder:"Enter announcement title"}),a.title&&e.jsx("span",{className:"text-red-500 text-sm",children:a.title})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"block text-sm font-medium",children:"Type"}),e.jsxs("select",{id:"type",value:s.type,onChange:t=>{c("type",t.target.value),c("content",""),c("description",""),x(null)},className:`mt-1 block w-full rounded-md border-gray-300 \r
                  shadow-sm text-gray-800 dark:text-slate-300`,children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"video",children:"Video"})]}),a.type&&e.jsx("span",{className:"text-red-500 text-sm",children:a.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Content"}),s.type==="text"?e.jsx(y,{value:S,onChange:t=>{const n=t||r;v(n),h.current=n},placeholder:"Write your announcement..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(j,{type:"file",accept:s.type==="image"?"image/*":"video/*",onChange:t=>{t.target.files&&t.target.files[0]&&x(t.target.files[0])}}),d&&e.jsxs("p",{className:"text-sm",children:["Selected file: ",d.name]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Caption / Description"}),e.jsx(y,{value:N,onChange:t=>{const n=t||r;A(n),f.current=n},placeholder:"Enter caption or description for the media..."})]})]}),a.content&&e.jsx("span",{className:"text-red-500 text-sm",children:a.content}),a.description&&e.jsx("span",{className:"text-red-500 text-sm",children:a.description})]}),e.jsx("div",{children:e.jsx(U,{type:"submit",disabled:p,children:p?"Submitting...":"Submit Announcement"})})]})})]})})]})}export{$ as default};
